<!DOCTYPE html>
<html lang="en">
<!--
Copyright 2012 Gary R. Van Sickle (grvs@users.sourceforge.net).

This file is part of CoFlo.

CoFlo is free software: you can redistribute it and/or modify it under the
terms of version 3 of the GNU General Public License as published by the Free
Software Foundation.

CoFlo is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE.  See the GNU General Public License for more details.
 
You should have received a copy of the GNU General Public License along with
CoFlo.  If not, see http://www.gnu.org/licenses/.
-->
<head>
	<meta charset="utf-8">

	<title>Insert title here</title>
	
	<!-- Dojo theme stylesheet. -->
	<!-- <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.8/dijit/themes/claro/claro.css" media="screen"> -->
	<link rel="stylesheet" href="js/dojo-release-1.8.1-src/dijit/themes/claro/claro.css" media="screen">

	<!-- CoFlo's CSS stylesheet -->
	<link rel="stylesheet" href="css/index.template.css" media="screen">

	<!-- <script src="js/coflo.resizer.js"></script> -->
	<!-- <script src="js/coflo.report.js"></script> -->
		
	<!-- load Dojo and provide config via the "data-dojo-config" data attribute -->
	<!-- <script src="http://ajax.googleapis.com/ajax/libs/dojo/1.8.0/dojo/dojo.js"
		data-dojo-config="async: true"></script> -->
	<script data-dojo-config="async: true" src="js/dojo-release-1.8.1-src/dojo/dojo.js"></script>
	<script>
    require(["dojo/ready", "dijit/registry", "dijit/layout/BorderContainer", "dijit/layout/ContentPane",
             "dijit/layout/StackContainer", "dijit/Tree", "dojo/query",
             "dijit/tree/ObjectStoreModel", "dojo/store/Memory", "dojo/aspect", "dojo/dom-geometry", "./js/coflo.resizer.js", "dojo/on", "dijit/Destroyable", "dijit/form/Button"],
             	function(ready, registry, BorderContainer, ContentPane, StackContainer, Tree, query, 
             			ObjectStoreModel, Memory, aspect)
             	{
    				ready(function()
					{
						// Create the main layout BorderContainer.
						var appLayout = new BorderContainer({
							design: "headline"
						}, "appLayout");
						
						// Create and add the Header pane.
						var headerPane = new ContentPane({
							region: "top",
							"class": "edgePanel",
							content: "Header content (top)"
							}, "header_pane");
						appLayout.addChild(headerPane);
						
						// Create an in-memory store for the tree.
						var myStore = new Memory({
							data: [
<!-- REMOVE_START -->
						            { id: 'all_files', name:'All Files', type:'theroot' },
						            { id: 'file1_c', name:'file1.c', type:'file', parent: 'all_files' },
						            { id: 'func1', tabid: 'tabs-1', name:'function1', type:'function', parent: 'file1_c' },
									{ id: 'func2', tabid: 'tabs-2', name:'function2', type:'function', parent: 'file1_c' },
						            { id: 'file2_c', name:'file2.c', type:'file', parent: 'all_files' },
									{ id: 'func3', tabid: 'tabs-3', name:'function3', type:'function', parent: 'file2_c' },
<!-- REMOVE_END -->
        							],
					        getChildren: function(object){
					        	return this.query({parent: object.id});
					        	}
							});
						
						var myModel = new ObjectStoreModel({
							store: myStore,
							query: {id: 'all_files'},
							mayHaveChildren: function(item){
								return item.type != "function";
								}
							});
						
						var myTree = new Tree({
							model: myModel,
							id: "myTree",
							onOpenClick: true,
							onClick: function(item){
								if(item.type == "function")
								{
									console.log('Tab with tabid='+item.tabid+' was clicked.');
									cfgstack.selectChild(item.tabid, false);
								}
							}
						}, "my_tree");
						
						// Create and add the navigation sidebar.
						navPane = new ContentPane({
							region: "left",
							id: "nav_pane",
							"class": "edgePanel",
							/*content: myTree,*/ /*"Sidebar content (left)",*/
							splitter: true}, "nav_pane");
						navPane.addChild(myTree);
						appLayout.addChild(navPane);
						
						// Create the main content stack.
						var cfgstack = new StackContainer({
							region: "center",
							id: "cfgstack",
							tabPosition: "bottom",
							"class": "centerPanel"}, "cfgstack");
						
						// Create a resizing function object.
						var resize_hook = function(changeSize, resultSize){
							console.log("resize hook called");
							// Find the contained svg.
							var the_this = this.domNode;
							var the_svg = query(".svg-cfg", this.domNode);
							if(the_svg.length != 1)
							{
								console.warn("Found ", the_svg.length, " SVG(s) in ", this, ", expected 1.");
							}
							fitToContainer(the_svg, this.domNode);
						}
						
						// Get a list of all the main content divs and create ContentPanes for them.
 						var panes = query(".cfg-pane");
 						panes.forEach(function(node, index, nodeList)
 						{
 							var cp1 = new ContentPane({
 								title: "Title Here"
 							}, node);
 							
 							// Add the resize hook which will fit the SVG to the pane.
							aspect.after(cp1, "resize", resize_hook, true);
 							
 							cfgstack.addChild(cp1);
 						});
						appLayout.addChild(cfgstack);
						
						appLayout.startup();
					});
             	});
    </script>
</head>

<body class="claro">

<!-- Div for the top-level layout container. -->
<div id="appLayout" class="demoLayout" data-dojo-type="dijit/layout/BorderContainer"
            data-dojo-props="design: 'headline'">

	<!-- The StackContainer making up the central panel. -->
	<div id="cfgstack" class="centerPanel" data-dojo-type="dijit/layout/StackContainer"
	    data-dojo-props="region: 'center'" data-dojo-id="myStackContainer">
	
	<!-- The individual panes. -->
	<!-- REMOVE_START -->
	<div id="tabs-1" class="cfg-pane" data-dojo-type="dijit/layout/ContentPane" title="Questions">
		<h4>Group 1 Content</h4>
		<button id="btn" data-dojo-type="dijit/form/Button"
			data-dojo-props="onClick:function(){ console.log('First button was clicked!'); }">
    		Click Me!
		</button>
	    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
	</div>
	<div id="tabs-2" class="cfg-pane" data-dojo-type="dijit/layout/ContentPane" title="decode_switches">
	    <object class="svg-cfg" type="image/svg+xml" data="decode_switches.svg"></object>
	</div>
	<div id="tabs-3" class="cfg-pane" data-dojo-type="dijit/layout/ContentPane" title="Another die" data-dojo-props="onShow:function(){ console.log('panel'); }">
	    <object class="svg-cfg" type="image/svg+xml" data="die.svg"></object>
	</div>
	<!-- REMOVE_END -->
	
	<!-- TAB_PANEL_LIST_START -->
 	<!-- TAB_PANEL_LIST_END -->

<!-- <div id="tabs" class="ui-tabs"> -->
<!-- 	<ul> -->
 		<!-- REMOVE_START -->
<!-- 		<li><a href="#tabs-1">decode_switches()</a></li> -->
<!-- 		<li><a href="#tabs-2">die()</a></li> -->
<!-- 		<li><a href="#tabs-3">Another die()</a></li> -->
 		<!-- REMOVE_END -->
		
 		<!-- TAB_LIST_START -->
 		<!-- TAB_LIST -->
<!-- 	</ul> -->
	
<!-- DOJO -->
	</div>
	<!-- Div for the header pane. -->
	<div id="header_pane" class="edgePanel" data-dojo-type="dijit/layout/ContentPane"
		data-dojo-props="region: 'top'">Header content (top)</div>
	<div id="nav_pane" class="edgePanel" data-dojo-type="dijit/layout/ContentPane"
		data-dojo-props="region: 'left', splitter: true">
		Sidebar content (left)
		<!-- Div for the tree control in the nav pane -->
		<div id="my_tree"></div>
	</div>
</div>
<!-- DOJO -->

</body>
</html>
